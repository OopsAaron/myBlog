---
title: 2020-08-31-ä¸€å‘¨è®ºæ–‡åˆ†äº«ï¼ˆç¬¬1æœŸï¼‰
mathjax: true
date: 2020-08-31 20:43:16
tags: [è®ºæ–‡,è®ºæ–‡åˆ†äº«,transformer]
top: 
categories: è®ºæ–‡åˆ†äº«
description: |
	è®°å½•æ¯å‘¨å€¼å¾—åˆ†äº«çš„è®ºæ–‡ï¼Œå‘¨ä¸€å‘å¸ƒã€
	ã€Šreformer-the eficient transformerã€‹ã€
	ã€ŠTransformer-XL-Attentive Language Models Beyond a Fixed-Length Contextã€‹
---

### reformerï¼šthe eficient transformer

#### è®ºæ–‡æ¦‚å†µ

- æ¥æºï¼šICLR 2020
- arXiv: 1901.02860
- ä½œè€…ï¼šNikita Kitaev ï¼ŒAnselm Levskaya
- è®ºæ–‡åœ°å€ï¼š[https://openreview.net/forum?id=rkgNKkHtvB](https://openreview.net/forum?id=rkgNKkHtvB)
- Code urlï¼š[https://github.com/google/trax/tree/master/trax/models/reformer](https://github.com/google/trax/tree/master/trax/models/reformer)
- è®ºæ–‡ç»„ä¼šæŠ¥å‘ŠäºŽ`2020.08.30`



#### èƒŒæ™¯

Transformeræž¶æž„è¢«å¹¿æ³›ç”¨äºŽè‡ªç„¶è¯­è¨€å¤„ç†ä¸­ï¼Œå¹¶åœ¨è®¸å¤šä»»åŠ¡ä¸Šäº§ç”Ÿäº†æœ€æ–°çš„ç»“æžœ

##### é—®é¢˜

1. å¤§åž‹çš„ Transformer å¯ä»¥åœ¨è®¸å¤šä»»åŠ¡ä¸Šå®žçŽ° sotaï¼Œä½†æ˜¯é¢ä¸´ç€å‚æ•°è¿‡å¤šçš„é—®é¢˜ï¼Œå¯¼è‡´æ‰€å å†…å­˜è¿‡å¤§ï¼Œé€ æˆèµ„æºç´§å¼ .

åœ¨æœ€å¤§çš„é…ç½®ä¸­ï¼Œå‚æ•°æ•°é‡å·²ç»è¶…è¿‡äº† 5äº¿/å±‚ï¼Œå±‚æ•°å¤šè¾¾ 64ã€‚

2. å…·æœ‰ *N* å±‚çš„æ¨¡åž‹è¦æ¶ˆè€— *N* å€äºŽå•å±‚æ¨¡åž‹çš„å†…å­˜ï¼Œå› ä¸ºæ¯ä¸€å±‚ä¸­çš„æ¿€æ´»éƒ½éœ€è¦å­˜å‚¨ä»¥è¿›è¡Œåå‘ä¼ æ’­ã€‚

3. ç”±äºŽç‚¹ä¹˜æ³¨æ„åŠ›æœ¬èº«çš„å±€é™æ€§ï¼Œå¯¼è‡´ä¸èƒ½å¤„ç†é•¿åºåˆ—æ•°æ®ï¼Œå¦åˆ™ä¼šå¯¼è‡´æ•ˆçŽ‡ä¸é«˜

ä¹Ÿå°±æ˜¯è¯´transformerçš„ä¸Šä¸‹æ–‡çª—å£æœ‰é™åˆ¶èŒƒå›´ã€‚æœ€å¤šä¹Ÿå°±å‡ åƒä¸ªå•è¯ã€‚



> Transformer çš„å¼ºå¤§æ¥æºäºŽæ³¨æ„åŠ›æœºåˆ¶ ï¼Œé€šè¿‡è¿™ä¸€æœºåˆ¶ï¼ŒTransformer å°†ä¸Šä¸‹æ–‡çª—å£å†…æ‰€æœ‰å¯èƒ½çš„å•è¯å¯¹çº³å…¥è€ƒè™‘ï¼Œä»¥ç†è§£å®ƒä»¬ä¹‹é—´çš„è”ç³»ã€‚å› æ­¤ï¼Œå¦‚æžœæ–‡æœ¬åŒ…å« 10 ä¸‡ä¸ªå•è¯ï¼ŒTransformer å°†éœ€è¦è¯„ä¼° 100 äº¿å•è¯å¯¹ï¼ˆ10 ä¸‡ x 10 ä¸‡ï¼‰ï¼Œè¿™æ˜¾ç„¶ä¸åˆ‡å®žé™…ã€‚
>
> å¦ä¸€ä¸ªé—®é¢˜æ˜¯å¦‚ä½•ä¿å­˜æ¯ä¸ªæ¨¡åž‹å±‚çš„è¾“å‡º ã€‚å¯¹äºŽä½¿ç”¨å¤§åž‹ä¸Šä¸‹æ–‡çª—å£çš„åº”ç”¨æ¥è¯´ï¼Œå­˜å‚¨å¤šä¸ªæ¨¡åž‹å±‚è¾“å‡ºçš„å†…å­˜éœ€æ±‚ä¼šè¿…é€Ÿå˜å¾—è¿‡å¤§ã€‚è¿™æ„å‘³ç€ï¼Œå®žé™…ä½¿ç”¨å¤§é‡å±‚çš„ Transformer æ¨¡åž‹åªèƒ½ç”¨äºŽç”Ÿæˆå‡ å°æ®µè½çš„æ–‡æœ¬æˆ–ä¸€å°æ®µçš„éŸ³ä¹ã€‚



##### è§£å†³æ–¹æ¡ˆ

1. ä½¿ç”¨å¯é€†æ®‹å·®ï¼ˆreversible residual layersï¼‰ä»£æ›¿æ ‡å‡†æ®‹å·®ï¼ˆstandard residualsï¼‰ï¼Œè¿™ä½¿å¾—å­˜å‚¨åœ¨è®­ç»ƒè¿‡ç¨‹ä¸­ä»…æ¿€æ´»ä¸€æ¬¡ï¼Œè€Œä¸æ˜¯ n æ¬¡ï¼ˆæ­¤å¤„ n æŒ‡å±‚æ•°ï¼‰ï¼Œæ›´æœ‰æ•ˆåœ°ä½¿ç”¨å¯ç”¨å†…å­˜ 

2. å°†ç‚¹ä¹˜æ³¨æ„åŠ›ï¼ˆdot-product attentionï¼‰æ›¿æ¢ä¸ºä¸€ä¸ªä½¿ç”¨å±€éƒ¨æ•æ„Ÿå“ˆå¸Œï¼ˆlocality-sensitive hashingï¼‰çš„ç‚¹ä¹˜æ³¨æ„åŠ›ï¼Œå°†å¤æ‚åº¦ä»Ž O(L2 ) å˜ä¸º O(L log L)ï¼Œæ­¤å¤„ L æŒ‡åºåˆ—çš„é•¿åº¦ï¼Œæ¥é™ä½Žé•¿åºåˆ—çš„å¤„ç†å¤æ‚åº¦



**Reformerä¸Žä½¿ç”¨å®Œå…¨Transformeræ‰€èŽ·å¾—çš„ç»“æžœç›¸åŒ¹é…ï¼Œä½†è¿è¡Œé€Ÿåº¦è¦å¿«å¾—å¤šï¼Œå°¤å…¶æ˜¯åœ¨æ–‡æœ¬ä»»åŠ¡ä¸Šï¼Œå¹¶ä¸”å†…å­˜æ•ˆçŽ‡è¦é«˜å‡ ä¸ªæ•°é‡çº§ã€‚**



#### æ³¨æ„åŠ›é—®é¢˜

##### åŽŸå§‹æ³¨æ„åŠ›

å…¬å¼å¦‚ä¸‹ï¼š$Attention (Q, K, V)=\operatorname{softmax}\left(\frac{Q K^{T}}{\sqrt{d_{k}}}\right) V$

self-attentionæ“ä½œçš„æ ¸å¿ƒ â€”â€”$QK^T$ è¡¨ç¤ºkeyå’Œqueryä¹‹é—´çš„ç›¸ä¼¼åº¦å¾—åˆ†

è®¡ç®—å¸¦æœ‰æ‰€æœ‰kçš„qçš„ç‚¹ç§¯ï¼Œå¹¶ç”¨âˆšdkè¿›è¡Œç¼©æ”¾ï¼Œç„¶åŽåº”ç”¨softmaxå‡½æ•°æ¥èŽ·å¾—vçš„æƒé‡ã€‚ç”¨æ¥æ¶ˆé™¤hidden sizeè¿™ä¸ªå‚æ•°å¯¹æ³¨æ„åŠ›åˆ†å¸ƒçš„å½±å“ã€‚å¯¹äºŽæ¯ä¸ªqueryï¼Œæˆ‘ä»¬åœ¨æ‰€æœ‰keysä¸Šè®¡ç®—ä¸€ä¸ªsoftmaxï¼Œä»¥ç¡®ä¿çŸ©é˜µçš„æ¯ä¸€è¡Œå’Œä¸º1â€”â€” ç¡®ä¿æ–°çš„éšè—çŠ¶æ€çš„å¤§å°ä¸ä¾èµ–äºŽåºåˆ—é•¿åº¦ã€‚

æœ€åŽï¼Œæˆ‘ä»¬ç”¨æˆ‘ä»¬çš„æ³¨æ„åŠ›çŸ©é˜µä¹˜ä»¥æˆ‘ä»¬çš„valuesçŸ©é˜µï¼Œä¸ºæ¯ä¸ªtokenç”Ÿæˆä¸€ä¸ªæ–°çš„éšè—è¡¨ç¤ºã€‚

------



> ##### ä¾‹å­
>
> Key:(batch, length,d_model)
>
> Query:(batch, length,d_model)
>
> -> $QK^T$ã€€:(batch, length,length)
>
> -> å¤æ‚åº¦ï¼š O($L^2$ ) 
>
> ->åŽŸå§‹çš„transformerç»“æž„éš¾ä»¥å¤„ç†è¿‡é•¿çš„åºåˆ—é•¿åº¦



![image-20200903163000933](https://i.loli.net/2020/09/03/9mdzrXcGKZ5FPi3.png)

![image-20200903161441529](https://i.loli.net/2020/09/03/6QvMn1qxGXzwKmC.png)





å…¶å®žï¼Œåœ¨softmaxä¸­ï¼Œå¯¹äºŽæ¯ä¸ªæŸ¥è¯¢ *q*ï¼Œæˆ‘ä»¬åªéœ€è¦æ³¨æ„æœ€æŽ¥è¿‘ *q* çš„é”® *k*ã€‚**å¹¶ä¸ä¸€å®šéœ€è¦é‚£äº›æ³¨æ„åŠ›æƒé‡å¾ˆå°çš„tokenã€‚**

ä¾‹å¦‚ï¼Œå¦‚æžœåºåˆ—é•¿åº¦æ˜¯ 64Kï¼Œå¯¹äºŽæ¯ä¸ª *q*ï¼Œæˆ‘ä»¬å¯ä»¥åªè€ƒè™‘ 32 æˆ– 64 ä¸ªæœ€è¿‘çš„é”®çš„ä¸€ä¸ªå°å­é›†ã€‚å› ä¸ºè¿™äº›æ˜¯å’Œ*q*æœ€éœ€è¦æ³¨æ„çš„



##### å±€éƒ¨æ•æ„Ÿå“ˆå¸Œ(LSH)

![image-20200903163152560](https://i.loli.net/2020/09/03/zQI9n2ubZYDV7SL.png)





å±€éƒ¨æ•æ„Ÿå“ˆå¸Œä½¿ç”¨`çƒå½¢æŠ•å½±ç‚¹çš„éšæœºæ—‹è½¬`ï¼Œé€šè¿‡argmaxåœ¨æœ‰ç¬¦å·è½´æŠ•å½±ä¸Š`å»ºç«‹æ¡¶ï¼ˆbucketï¼‰`ã€‚ åœ¨æ­¤é«˜åº¦ç®€åŒ–çš„2Dæç»˜ä¸­ï¼Œå¯¹äºŽä¸‰ä¸ªä¸åŒçš„è§’åº¦hashï¼Œä¸¤ä¸ªç‚¹xå’Œyä¸å¤ªå¯èƒ½å…±äº«ç›¸åŒçš„å“ˆå¸Œæ¡¶ï¼ˆä¸Šæ–¹ï¼‰ï¼Œé™¤éžå®ƒä»¬çš„çƒé¢æŠ•å½±å½¼æ­¤é è¿‘ï¼ˆä¸‹æ–¹ï¼‰ã€‚

è¯¥å›¾æ¼”ç¤ºäº†ä¸€ä¸ªç”¨`4ä¸ªæ¡¶è¿›è¡Œ3è½®å“ˆå¸Œçš„è®¾ç½®`ã€‚ä¸‹é¢çš„å›¾ä¸­çš„å‘é‡æ˜ å°„åˆ°äº†åŒä¸€ä¸ªbucketï¼Œå› ä¸ºå®ƒä»¬çš„è¾“å…¥å¾ˆæŽ¥è¿‘ï¼Œè€Œä¸Šä¸€å¼ å›¾ä¸­çš„å‘é‡æ˜ å°„åˆ°ç¬¬ä¸€ä¸ªå’Œæœ€åŽä¸€ä¸ªbucketã€‚



LSHæ˜¯ä¸€ç»„å°†é«˜ç»´å‘é‡æ˜ å°„åˆ°ä¸€ç»„ç¦»æ•£å€¼(æ¡¶/é›†ç¾¤)çš„æ–¹æ³•ã€‚æ˜¯è§£å†³åœ¨é«˜ç»´ç©ºé—´ä¸­å¿«é€Ÿæ‰¾åˆ°æœ€è¿‘é‚»å±…ï¼ˆæœ€ç›¸ä¼¼ï¼‰çš„é—®é¢˜ã€‚

`åŸºæœ¬æ€æƒ³`ï¼šé€‰æ‹© *hash* å‡½æ•°ï¼Œå¯¹äºŽä¸¤ä¸ªç‚¹ p å’Œ qï¼Œå¦‚æžœ q æŽ¥è¿‘ pï¼Œé‚£ä¹ˆå¾ˆæœ‰å¯èƒ½æˆ‘ä»¬æœ‰ hash(q) == hash(p) 



##### LSHæ³¨æ„åŠ›

![image-20200903163641310](https://i.loli.net/2020/09/03/KgnJ7iB2kImcshX.png)

å®Œå…¨ä¸åŒçš„æ–¹æ³•æ¥å¤„ç†åºåˆ—é•¿åº¦é—®é¢˜ï¼Œä¸¢å¼ƒäº†`queryæŠ•å½±`ï¼ˆQ=Kï¼‰ï¼ˆå®žéªŒç»“æžœå‘çŽ°ï¼Œå­¦ä¹ ä¸åŒçš„keyså’Œqueriesçš„æŠ•å½±å¹¶ä¸æ˜¯ä¸¥æ ¼å¿…è¦çš„ï¼‰ï¼Œ`å¹¶å°†æ³¨æ„åŠ›æƒé‡æ›¿æ¢ä¸ºkeyçš„å‡½æ•°ï¼ˆhashå‡½æ•°ï¼‰`ï¼Œä»¥æ­¤é™ä½Žå¤æ‚åº¦



æ­¥éª¤å¦‚ä¸‹ï¼š

1.ä½¿ç”¨LSHä¸ºæ¯ä¸ªtokenè®¡ç®—ä¸€ä¸ªæ¡¶

2.æ ¹æ®ç›¸åŒçš„æ¡¶è¿›è¡Œå½’ç±»æŽ’åº

3.åˆ†å—å¹¶å°†æ ‡å‡†çš„ç‚¹ä¹˜æ³¨æ„åŠ›åº”ç”¨åˆ°æ¡¶ä¸­çš„tokençš„å—ä¸Šï¼Œä»Žè€Œå¤§å¤§é™ä½Žè®¡ç®—è´Ÿè½½



#### å†…å­˜é—®é¢˜

å•å±‚èƒ½å¤Ÿæ‰§è¡Œé•¿åºåˆ—çš„å•æ¨¡åž‹ã€‚ä½†æ˜¯ï¼Œå½“ä½¿ç”¨æ¢¯åº¦ä¸‹é™è®­ç»ƒå¤šå±‚æ¨¡åž‹æ—¶ï¼Œç”±äºŽéœ€è¦ä¿å­˜æ¯ä¸€å±‚çš„æ¿€æ´»ï¼ˆå‡½æ•°ï¼‰ï¼Œä»¥ç”¨äºŽæ‰§è¡Œé€†æŽ¨ã€‚ä¸€ä¸ªä¼ ç»Ÿçš„ Transformer æ¨¡åž‹å…·æœ‰åå‡ ä¸ªæˆ–æ›´å¤šçš„å±‚ï¼Œé€šè¿‡ç¼“å­˜è¿™äº›å±‚çš„å€¼ï¼Œå†…å­˜å°†ä¼šå¾ˆå¿«ç”¨å®Œã€‚

å¯é€†å±‚ï¼šåœ¨åå‘ä¼ æ’­æ—¶ï¼ŒæŒ‰éœ€é‡æ–°è®¡ç®—æ¯ä¸ªå±‚çš„è¾“å…¥ï¼Œè€Œä¸æ˜¯å°†å…¶ä¿å­˜åœ¨å†…å­˜ä¸­ã€‚å…¶ä¸­æ¥è‡ªç½‘ç»œæœ€åŽä¸€å±‚çš„æ¿€æ´»ç”¨äºŽè¿˜åŽŸæ¥è‡ªä»»ä½•ä¸­é—´å±‚çš„æ¿€æ´»ã€‚



åŽŸå§‹çš„æ®‹å·®ç½‘ç»œï¼š$Y=F(x)$

å¯é€†å±‚çš„æ®‹å·®ç½‘ç»œï¼š æ³¨æ„æˆ‘ä»¬å¦‚ä½•ä»Žå®ƒçš„è¾“å‡º(Y â‚, Y â‚‚)è®¡ç®—ç‰©ä½“çš„è¾“å…¥(X â‚, X â‚‚)ã€‚

$\begin{array}{ll}y_{1}=x_{1}+F\left(x_{2}\right) & y_{2}=x_{2}+G\left(y_{1}\right) \\ x_{2}=y_{2}-G\left(y_{1}\right) & x_{1}=y_{1}-F\left(x_{2}\right) \\ Y_{1}=X_{1}+\text { Attention }\left(X_{2}\right) & Y_{2}=X_{2}+\text { FeedForward }\left(Y_{1}\right)\end{array}$

ç¤ºæ„å›¾å¦‚ä¸‹

![image-20200903164816966](https://i.loli.net/2020/09/03/WX3lcQrmB16pI2Y.png)



![image-20200903164907447](https://i.loli.net/2020/09/03/FgHKa4QNrsjlzMh.png)



#### å®žéªŒ

ä½œè€…åˆ†åˆ«å¯¹å›¾åƒç”Ÿæˆä»»åŠ¡ *imagenet64*(é•¿åº¦ä¸º 12K)å’Œæ–‡æœ¬ä»»åŠ¡ *enwik8*(é•¿åº¦ä¸º 64K)è¿›è¡Œäº†å®žéªŒï¼Œè¯„ä»·äº†å¯é€† Transformer å’Œ LSH å“ˆå¸Œå¯¹å†…å­˜ã€ç²¾åº¦å’Œé€Ÿåº¦çš„å½±å“ã€‚

ðŸŽ‰å¯é€† Transformer åŒ¹é…åŸºå‡†ï¼šä»–ä»¬çš„å®žéªŒç»“æžœè¡¨æ˜Žï¼Œå¯é€†çš„ Transformer å¯ä»¥èŠ‚çœå†…å­˜ä¸ç‰ºç‰²ç²¾åº¦ï¼š

![null](https://i.loli.net/2020/09/03/LwSPM5qFuBfQhaZ.png)

åœ¨ enwik8 å’Œ imagenet64 è®­ç»ƒä¸­ï¼Œå¯é€†æ€§å¯¹æ€§èƒ½çš„å½±å“

ðŸŽ‰LSH æ³¨æ„åŠ›åŒ¹é…åŸºå‡†ï¼šæ³¨æ„ LSH æ³¨æ„åŠ›æ˜¯ä¸€ä¸ªè¿‘ä¼¼çš„å…¨æ³¨æ„åŠ›ï¼Œå…¶å‡†ç¡®æ€§éšç€æ•£åˆ—å€¼çš„å¢žåŠ è€Œæé«˜ã€‚å½“å“ˆå¸Œå€¼ä¸º 8 æ—¶ï¼ŒLSH çš„æ³¨æ„åŠ›å‡ ä¹Žç­‰äºŽå®Œå…¨æ³¨æ„åŠ›ï¼š

![null](https://i.loli.net/2020/09/03/t4zNAXOf6iEZ7cH.jpg)

LSH æ³¨æ„åŠ›ä½œä¸ºæ•£åˆ—å¾ªçŽ¯å¯¹ imagenet64 çš„å½±å“

ðŸŽ‰ä»–ä»¬ä¹Ÿè¯æ˜Žäº†ä¼ ç»Ÿæ³¨æ„åŠ›çš„é€Ÿåº¦éšç€åºåˆ—é•¿åº¦çš„å¢žåŠ è€Œå˜æ…¢ï¼Œè€Œ LSH æ³¨æ„åŠ›é€Ÿåº¦ä¿æŒç¨³å®šï¼Œå®ƒè¿è¡Œåœ¨åºåˆ—é•¿åº¦~ 100k åœ¨ 8GB çš„ GPU ä¸Šçš„æ­£å¸¸é€Ÿåº¦ï¼š

![null](https://i.loli.net/2020/09/03/aGRcA42EiNSBz8v.jpg)

æ³¨æ„åŠ›è¯„ä¼°çš„é€Ÿåº¦ä½œä¸ºå…¨æ³¨æ„åŠ›å’Œ LSH æ³¨æ„åŠ›çš„è¾“å…¥é•¿åº¦çš„å‡½æ•°

> ä¸Ž Transformer æ¨¡åž‹ç›¸æ¯”ï¼Œæœ€ç»ˆçš„ Reformer æ¨¡åž‹å…·æœ‰æ›´é«˜çš„å­˜å‚¨æ•ˆçŽ‡å’Œæ›´å¿«çš„å­˜å‚¨é€Ÿåº¦ã€‚



#### ðŸš€å‚è€ƒ

> [https://www.6aiq.com/article/1583729200869](https://www.6aiq.com/article/1583729200869)
>
> [https://thinkwee.top/2020/02/07/reformer/](https://thinkwee.top/2020/02/07/reformer/)
>
> [https://aijishu.com/a/1060000000100293](https://aijishu.com/a/1060000000100293)



### Transformer-XL : Attentive Language Models Beyond a Fixed-Length Context

#### è®ºæ–‡æ¦‚å†µ

- æ¥æºï¼šACL 2019
- arXiv: 1901.02860
- ä½œè€…ï¼šZihangDai , ZhilinYang , YimingYang
- è®ºæ–‡åœ°å€ï¼š [https://arxiv.org/abs/1901.02860](https://arxiv.org/abs/1901.02860)
- Code urlï¼š[https://github.com/kimiyoung/transformer-xl](https://github.com/kimiyoung/transformer-xl)
- è®ºæ–‡ç»„ä¼šæŠ¥å‘ŠäºŽ`2020.08.15`



#### èƒŒæ™¯

##### é—®é¢˜

Transformerå­˜åœ¨å±€é™æ€§ï¼š

1.åœ¨è¯­è¨€å»ºæ¨¡æ—¶çš„è®¾ç½®å—åˆ°å›ºå®šé•¿åº¦ï¼ˆsegmentï¼‰çš„é™åˆ¶ã€‚å¯¹é•¿è·ç¦»ä¾èµ–çš„å»ºæ¨¡èƒ½åŠ›ä»ç„¶ä¸è¶³

2.å› ä¸ºtransformerå°†æ–‡æœ¬ç­‰åˆ†ä¸ºç›¸åŒçš„ç‰‡æ®µï¼Œå¯¼è‡´äº†ä¸Šä¸‹æ–‡ç¢Žç‰‡



##### è§£å†³æ–¹æ¡ˆ

ä½¿å­¦ä¹ ä¸å†ä»…ä»…ä¾èµ–äºŽå®šé•¿ï¼Œä¸”ä¸ç ´åæ—¶é—´çš„ç›¸å…³æ€§ã€‚

1. æå‡º**ç‰‡æ®µçº§é€’å½’æœºåˆ¶(segment-level recurrence mechanism)**ï¼Œå¼•å…¥ä¸€ä¸ª**è®°å¿†(memory)**æ¨¡å—ï¼ˆç±»ä¼¼äºŽcacheæˆ–cellï¼‰  ä¹‹å‰è®¡ç®—è¿‡äº†ä¸éœ€è¦é‡å¤è®¡ç®—ï¼Œç›´æŽ¥ä¸ºåŽé¢ç‰‡æ®µä½¿ç”¨ã€‚

- ä½¿å¾—`é•¿è·ç¦»ä¾èµ–çš„å»ºæ¨¡`æˆä¸ºå¯èƒ½ï¼›
- ä½¿å¾—ç‰‡æ®µä¹‹é—´äº§ç”Ÿäº¤äº’ï¼Œè§£å†³ä¸Šä¸‹æ–‡ç¢Žç‰‡åŒ–é—®é¢˜



2.æå‡º**ç›¸å¯¹ä½ç½®ç¼–ç æœºåˆ¶**ï¼Œä»£æ›¿ç»å¯¹ä½ç½®ç¼–ç ã€‚ Transformerçš„ç»å¯¹ä½ç½®ç¼–ç æŒ‡çš„æ˜¯ä¸€ä¸ªç‰‡æ®µä¸­ï¼Œä¸º1 ä¸º2 ã€‚å¦‚æžœæ˜¯å¤šä¸ªç‰‡æ®µåŒæ—¶è€ƒè™‘çš„è¯ï¼Œé‚£ä¹ˆè¿™ç§1ï¼Œ2å°±ä¼šé‡å¤ï¼Œæ‰€ä»¥ä½¿ç”¨äº†ç›¸å¯¹ä½ç½®ç¼–ç çš„æ–¹æ³•ã€‚è¿™æ ·å¯ä»¥åœ¨å¤šä¸ªç‰‡æ®µï¼ˆsegmentï¼‰ä¸­ä½¿ç”¨ç›¸å¯¹ç¼–ç ã€‚å…·ä½“å†…å®¹è§è®ºæ–‡

æ³¨ï¼šä¸¤è€…æ˜¯ä¸€èµ·ä½¿ç”¨çš„ï¼Œå…±åŒè§£å†³transformerå­˜åœ¨çš„å±€é™æ€§



#### æ¨¡åž‹ transformer-XL

##### åŽŸå§‹transformer

![v2-732805e00feb35e41f1d00f8df516950_b](https://i.loli.net/2020/09/04/YU3mC2hIOA9ncrj.gif)



##### ç‰‡æ®µæ³¨æ„åŠ›æœºåˆ¶

ä¸ºäº†è§£å†³é•¿è·ç¦»ä¾èµ–ï¼Œæ–‡ç« å¼•å…¥ä¸€ä¸ªmemoryçŠ¶æ€ã€‚

åœ¨è®­ç»ƒè¿‡ç¨‹ä¸­ï¼Œæ¯ä¸ªç‰‡æ®µçš„è¡¨ç¤ºä¸ºæœ€åŽçš„éšå±‚çŠ¶æ€ï¼Œè¡¨ç¤ºç‰‡æ®µçš„åºå·ï¼Œè¡¨ç¤ºç‰‡æ®µçš„é•¿åº¦ï¼Œè¡¨ç¤ºéšå±‚ç»´åº¦ã€‚

åœ¨è®¡ç®—ç‰‡æ®µçš„è¡¨ç¤ºæ—¶ï¼Œç”¨memoryç¼“å­˜ç‰‡æ®µå±‚çš„éšå±‚çŠ¶æ€ï¼Œç”¨æ¥æ›´æ–°ï¼Œè¿™æ ·å°±ç»™ä¸‹ä¸€ä¸ªç‰‡æ®µåŒäº†ä¸Šæ–‡ï¼Œé•¿è·ç¦»ä¾èµ–ä¹Ÿé€šè¿‡memoryä¿å­˜äº†ä¸‹æ¥ã€‚å¹¶ä¸”ï¼Œæœ€å¤§å¯èƒ½çš„ä¾èµ–é•¿åº¦çº¿æ€§å¢žé•¿ï¼Œè¾¾åˆ°**N*L**

![v2-a8210cd2f9bfb9307ba81d694dc4e4b4_b](https://i.loli.net/2020/09/04/IjUWo7DahsNPAkv.gif)



##### è¯„ä¼°é˜¶æ®µ

###### åŽŸå§‹transformer

![v2-13a38126e684b838e5ed207fd5cae944_b](https://i.loli.net/2020/09/04/epOcXjYTy835dJv.gif)



###### Transformer-XL

![v2-502e1e1fec12b326ace579e059b3b3df_b](https://i.loli.net/2020/09/04/qdYL5RsQEOFS8nG.gif)









#### å®žéªŒ

å®žéªŒéƒ¨åˆ†æ˜¯å¯¹åŸºäºŽTransformer-XLçš„è¯­è¨€æ¨¡åž‹è¿›è¡Œè¯„ä¼°ï¼Œåˆ†ä¸ºå­—ç¬¦çº§å’Œè¯çº§ã€‚è¯„ä»·æŒ‡æ ‡åˆ†åˆ«æ˜¯bpc(æ¯å­—ç¬¦ä½æ•°)å’ŒPPL(å›°æƒ‘åº¦)ï¼Œè¶Šå°è¶Šå¥½ã€‚enwiki8å’Œtext8ç”¨çš„æ˜¯bpcã€‚Transformer-XLåœ¨å¤šä¸ªè¯­è¨€æ¨¡åž‹åŸºå‡†æµ‹è¯•ä¸­å®žçŽ°äº†æœ€å…ˆè¿›çš„ç»“æžœã€‚ Transformer-XLç¬¬ä¸€ä¸ªåœ¨charçº§è¯­è¨€æ¨¡åž‹åŸºå‡†enwiki8ä¸Šçªç ´1.0ã€‚



**åŽ»é™¤å®žéªŒï¼š**

![image-20200904153950861](https://i.loli.net/2020/09/04/ZV1lpewdtanoWi9.png)



é‡ç‚¹æ˜¯æœ¬æ–‡è®¾è®¡çš„ç›¸å¯¹ä½ç½®ç¼–ç **ä¼˜äºŽ**å…¶ä»–å·¥ä½œï¼Œmemoryçš„è®¾è®¡ä¹Ÿæœ‰å¾ˆå¤§çš„æå‡ã€‚

æœ€åŽï¼ŒTransformer-XLåœ¨è¯„ä¼°é˜¶æ®µçš„é€Ÿåº¦ä¹Ÿæ˜Žæ˜¾å¿«äºŽ vanilla Transformerï¼Œç‰¹åˆ«æ˜¯å¯¹äºŽè¾ƒé•¿çš„ä¸Šä¸‹æ–‡ã€‚ä¾‹å¦‚ï¼Œå¯¹äºŽ 800 ä¸ªå­—ç¬¦çš„ä¸Šä¸‹æ–‡é•¿åº¦ï¼ŒTransformer-XL æ¯”Vanilla Transformer å¿« 363 å€ï¼›è€Œå¯¹äºŽ 3800 å­—ç¬¦çš„ä¸Šä¸‹æ–‡ï¼ŒTransformer-XL å¿«äº† 1874 å€ã€‚



#### åˆ›æ–°ç‚¹

- æå‡ºäº†ç‰‡æ®µçº§é€’å½’æœºåˆ¶å’Œç›¸å¯¹ä½ç½®ç¼–ç æœºåˆ¶
- ä¾èµ–å…³ç³»æ¯”åŽŸå§‹Transformeré•¿450ï¼…ï¼Œå¹¶ä¸”åœ¨è¯„ä¼°è¿‡ç¨‹ä¸­ï¼Œå…¶é€Ÿåº¦æ¯”åŽŸå§‹Transformerå¿«1800å€ä»¥ä¸Š







#### ðŸš€å‚è€ƒ

> [https://www.cnblogs.com/shona/p/12041055.html](https://www.cnblogs.com/shona/p/12041055.html)
>
> [https://zhuanlan.zhihu.com/p/83062195](https://zhuanlan.zhihu.com/p/83062195)
>
> [https://www.cnblogs.com/mj-selina/p/12373636.html](https://www.cnblogs.com/mj-selina/p/12373636.html)
>
> [https://zhuanlan.zhihu.com/p/70745925](https://zhuanlan.zhihu.com/p/70745925)



