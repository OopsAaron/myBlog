---
title: 2020-08-31-git进阶
mathjax: true
date: 2020-08-31 16:41:49
tags: git
top:
categories: git
description: git的进阶使用总结
---

### 前言

之前总结过git的一些基本命令，后来使用了更多git，写博客用于记录。不断更新 ，在实践中总结git知识点。



### git status 和 git diff

在对文件进行修改之后，可以用 `git status` 查看结果，可以让我们时刻掌握仓库当前的状态

<img src="https://i.loli.net/2020/08/31/fTmxaAeZG1iSCLd.png" alt="image-20200831180231338" style="zoom:67%;" />

可以看到在`modified`部分，可以看到有四个文件被修改了，但是还没有被提交的修改

上述只是看到被修改的文件，但如果能看看具体修改了什么内容就好了，`git diff` 可以实现这个功能

<img src="https://i.loli.net/2020/08/31/nVd3hGKLJy6f7zH.png" alt="image-20200831194816455"  />

可以看到修改的详细细节（红色为修改前的内容，绿色为修改后的内容）。向下箭头可以下拉文本，`q`退出查看 （quit）



这样就可以放心的提交到仓库

```bash
git add .
git commit -m 20/8/31/commit1
```



#### 小结

- 要随时掌握工作区的状态，使用`git status`命令。
- 如果`git status`告诉你有文件被修改过，用`git diff`可以查看修改内容。



### 版本回退

每当文件修改到一定程度的时候，就可以“保存一个快照”，这个快照在Git中被称为`commit`。一旦你把文件改乱了，或者误删了文件，还可以从最近的一个`commit`恢复，然后继续工作，而不是把几个月的工作成果全部丢失。

在Git中，我们用`git log`命令查看：

<img src="https://i.loli.net/2020/08/31/4lC7ufP6ZmbUvWT.png" alt="image-20200831233324006" style="zoom:80%;" />

`git log`命令显示从最近到最远的提交日志，每一次`commit`很详细

可以加上`--pretty=oneline`参数，来简化显示。推荐使用

<img src="https://i.loli.net/2020/08/31/xNXAn7Pt8rT2mcE.png" alt="image-20200831233340202" style="zoom:80%;" />

其中前面编号类似`012214236e...`的是`commit id`（版本号），是一个`SHA1`计算出来的一个非常大的数字，用十六进制表示

每个人的编号不一样，因为Git是分布式的版本控制系统，多人在同一个版本库里工作，如果大家都用1，2，3……作为版本号，那肯定就冲突了。

> [Hash在线计算、md5计算、sha1计算、sha256计算、sha512计算](https://1024tools.com/hash)

我们就可以进行回退操作

首先，Git必须知道当前版本是哪个版本。

在Git中，用`HEAD`表示当前版本，也就是最新的提交`012214236e...`，上一个版本就是`HEAD^`，上上一个版本就是`HEAD^^`，当然往上100个版本写100个`^`比较容易数不过来，所以写成`HEAD~100`。

我们可以使用`git reset`命令：

```bash
git reset --hard HEAD^ #回退到上一版本
```

![image-20200831233416378](https://i.loli.net/2020/08/31/k37ptdoMJxGcufR.png)

结果显示出现在是`ca41b0a`，也就是上一次`commit`的版本。我们成功回退版本！

当我们再查看日志的时候，发现已经没有`20/8/31/commit1`版本了

![image-20200831233446124](https://i.loli.net/2020/08/31/xWIlbtTwazUJNdO.png)

------

如果想要再还原到`20/8/31/commit1`版本呢？

也是可以的，只要**`上面的命令行窗口还没有被关掉`**，就可以顺着往上找，找到那个`20/8/31/commit1`版本的`commit id`是`012214236e...`，于是就可以指定回到未来的某个版本：

```bash
git reset --hard 0221423
```

![image-20200831233507305](https://i.loli.net/2020/08/31/9pK7UsnRrv1loSD.png)

版本号没必要写全，前几位就可以了，Git会自动去找。当然也不能只写前一两位，因为Git可能会找到多个版本号，就无法确定是哪一个了。

这样就实现了还原到最后`commit`版本



> **注！！！**
>
> 如果从历史版本回到最后的版本，也只能还原到最后`commit`后的版本。
>
> 我才开始`commit`了版本A，之后又写了一部分内容 B(未`commit`)。还原到了A-1版本，之后又想还原到A+B版本，操作完之后发现还原后的没有B部分，也就是我只能还原到A。
>
> 原因就是我在最后一次`commit`就是A，而写完B之后，没有`commit` ，于是无法还原。 （多多`commit`，
>
> ，还原需谨慎。我是真的折腾）:sob:



#### 小结

- `HEAD`指向的版本就是当前版本，因此，Git允许我们在版本的历史之间穿梭，使用命令`git reset --hard commit_id`。
- 穿梭前，用`git log`可以查看提交历史，以便确定要回退到哪个版本。
- 要重返未来，用`git reflog`查看命令历史，以便确定要回到未来的哪个版本。

#### 参考

> [常用git命令清单-阮一峰](http://www.ruanyifeng.com/blog/2015/12/git-cheat-sheet.html)
>
> [读懂diff-阮一峰](http://www.ruanyifeng.com/blog/2012/08/how_to_read_diff.html)
>
> [git教程-廖雪峰](https://www.liaoxuefeng.com/wiki/0013739516305929606dd18361248578c67b8067c8c017b000)
>
> [git教程-菜鸟教程](http://www.runoob.com/git/git-install-setup.html)
>
> [gitbook](https://git-scm.com/book/zh/v2)
>
> [Git Community Book](http://gitbook.liuhui998.com/index.)
>
> [从只会git add .的菜鸟到掌握git基本功能](https://juejin.im/post/6844903586023866375)



